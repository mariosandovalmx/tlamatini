<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tlamatini">
<title>Tlamatini - Modelos Lineales Generalizados (GLM) • tlamatini</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tlamatini - Modelos Lineales Generalizados (GLM)">
<meta property="og:description" content="tlamatini">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tlamatini</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Tlamatini-Modelos-Lineales-Generalizados-GLM.html">Tlamatini - Modelos Lineales Generalizados (GLM)</a>
    <a class="dropdown-item" href="../articles/Tlamatini-Modelos-Lineales-Generalizados-Mixtos-GLMM.html">Tlamatini - Modelos Lineales Generalizados Mixtos (GLMM)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mariosandovalmx/tlamatini/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tlamatini - Modelos Lineales Generalizados (GLM)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mariosandovalmx/tlamatini/blob/HEAD/vignettes/Tlamatini-Modelos-Lineales-Generalizados-GLM.Rmd" class="external-link"><code>vignettes/Tlamatini-Modelos-Lineales-Generalizados-GLM.Rmd</code></a></small>
      <div class="d-none name"><code>Tlamatini-Modelos-Lineales-Generalizados-GLM.Rmd</code></div>
    </div>

    
    
<p><img src="https://raw.githubusercontent.com/mariosandovalmx/ecology/ddc9d3c8fd1d40523bf7e9625a028e4dad7772af/images/tlamatini-logo.jpg" style="width:70.0%" alt="Tlamatini">
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
## … —-
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
<p>Este paquete contiene funciones útiles para el análisis de datos,
principalmente para modelos lineales (LM, GLM, GLMM). Aunque está
pensado para usarse en Ciencias Biológicas, su aplicación se extiende a
cualquier área del conocimiento que requiera análisis estadísticos. Es
una compilación de funciones útiles creadas por mi o por alguien más,
que facilitan el análisis de datos: exploración y transformaciones de
datos, revisión de los supuestos de los modelos lineales (LM, LMM, GLM,
GLMM), exportación de tablas, entre otros.</p>
<p>Para más información sobre el paquete y actualizaciones, visita la
página: <a href="https://mariosandovalmx.github.io/tlamatini-website/" class="external-link">https://mariosandovalmx.github.io/tlamatini-website/</a></p>
<p>Para citar este paquete: Mario A. Sandoval-Molina (2021). tlamatini:
Funciones útiles para biologxs y ecologxs confundidos con los modelos
lineales. R package. <a href="https://doi.org/10.5281/zenodo.7765347" class="external-link uri">https://doi.org/10.5281/zenodo.7765347</a></p>
<p>Si quieres conocer más de mi trabajo, visita mi pagina web: <a href="https://mariosandovalmx.github.io/ecology/" class="external-link">https://mariosandovalmx.github.io/ecology/</a></p>
<p>Para este ejemplo sobre como ajustar Modelos Lineales Generalizados
(GLM) usando Tlamatini vamos a usar una base de datos ficticia (los
datos no son reales) que contiene la longitud hocico-cloaca de
lagartijas de la especie <em>Sceloporus torquatus</em> en cuatro
localidades distintas, que vamos a llamar A, B, C y D. Además, contiene
la velocidad de desplazamiento y el tiempo de reacción de cada
lagartija.</p>
<p>La base de datos se puede descargar del siguiente enlace: <a href="https://github.com/mariosandovalmx/examples-data/blob/53d82952ea60a25611d99dd6a7c0e6510d5bac7d/datos.GLM1.csv" class="external-link">descargar
datos</a></p>
<p>Vamos a cargar la base de datos:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/mariosandovalmx/examples-data/main/datos.GLM1.csv"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>##Exploración de datos Así luce nuestra base de datos:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;         LHC Velocidad   Tiempo   Localidad</span></span>
<span><span class="co">#&gt; 1  8.362033  5.625505 7.632080 Localidad_A</span></span>
<span><span class="co">#&gt; 2 11.762914  3.847125 6.518618 Localidad_D</span></span>
<span><span class="co">#&gt; 3  9.119546  6.067273 9.053450 Localidad_A</span></span>
<span><span class="co">#&gt; 4 10.207365  5.128038 7.369430 Localidad_C</span></span>
<span><span class="co">#&gt; 5 11.480672  3.274195 5.931493 Localidad_D</span></span>
<span><span class="co">#&gt; 6  9.837144  5.588090 8.415775 Localidad_B</span></span></code></pre></div>
<p>Para este ejemplo vamos a comenzar cargando la paquetería.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tlamatini</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">#&gt; ##                            Tlamatini - R package                         ----</span></span>
<span><span class="co">#&gt; ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; El paquete Tlamatini se ha cargado con éxito. ¡Espero que lo disfrutes!</span></span>
<span><span class="co">#&gt;  Actualizaciones y más información en:</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;   https://mariosandovalmx.github.io/tlamatini-website/</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Email de contacto: sandoval.m@hotmail.com </span></span>
<span><span class="co">#&gt; Para citar este paquete: Mario A. Sandoval-Molina (2021). tlamatini: Funciones utiles </span></span>
<span><span class="co">#&gt; para biologxs y ecologxs confundidos con los modelos lineales. R package. https://doi.org/10.5281/zenodo.7765347</span></span></code></pre></div>
<p>Vamos a comenzar por convertir todas las variables categóricas a
factor. La función <em>as_factorALL</em> va a reconocer todas las
variables que son tipo “caracter” y las va a codificar como factor
automáticamente. Nota: solo funciona con variables que contienen letras,
no funciona si la columna es numérica.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_factorALL.html">as_factorALL</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Todas las columnas tipo caracter convertidas a factores</span></span></code></pre></div>
<p>Vamos a explorar si hay datos faltantes en las variables numéricas,
también vemos la media, el mínimo y máximo de cada variable, además de
otros parámetros.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/numSummary.html">numSummary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;             n media    sd   max  min rango nunicos nceros  iqr limitinferior</span></span>
<span><span class="co">#&gt; LHC       100 10.05 1.048 13.10 7.78  5.32     100      0 1.51          7.02</span></span>
<span><span class="co">#&gt; Velocidad 100  5.07 1.317 14.19 2.35 11.84     100      0 1.23          2.53</span></span>
<span><span class="co">#&gt; Tiempo    100  7.48 0.913  9.93 4.94  4.98     100      0 1.16          5.12</span></span>
<span><span class="co">#&gt;           limitesuperior noutlier kurtosis asimetria mode faltantes %faltantes</span></span>
<span><span class="co">#&gt; LHC                13.10        1   -0.290     0.179 8.36         0          0</span></span>
<span><span class="co">#&gt; Velocidad           7.44        2   20.799     3.118 5.63         0          0</span></span>
<span><span class="co">#&gt; Tiempo              9.71        2    0.147    -0.026 7.63         0          0</span></span>
<span><span class="co">#&gt;             1%   5%  25%  50%   75%   95%   99%</span></span>
<span><span class="co">#&gt; LHC       7.90 8.35 9.29 9.96 10.82 11.76 12.03</span></span>
<span><span class="co">#&gt; Velocidad 2.84 3.34 4.36 5.08  5.60  6.79  7.06</span></span>
<span><span class="co">#&gt; Tiempo    5.44 6.00 6.85 7.53  7.97  8.91  9.59</span></span></code></pre></div>
<p>También podemos explorar las variables categóricas:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/charSummary.html">charSummary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;     n faltantes %faltantes unique</span></span>
<span><span class="co">#&gt; E 100         0          0      4</span></span>
<span><span class="co">#&gt;                                                     top5:conteos</span></span>
<span><span class="co">#&gt; E Localidad_A:25, Localidad_B:25, Localidad_C:25, Localidad_D:25</span></span></code></pre></div>
<p>¡No hay datos faltantes en las variables!</p>
<p>También nos interesa saber cómo se relacionan las variables
explicativas con nuestra variable de respuesta, en este caso velocidad.
Para ello usamos la función <em>ggpairs_dfnum</em>, que nos da el valor
de correlación y el valor de p. Como vemos en la gráfica, la velocidad
de desplazamiento de las lagartijas se correlaciona negativamente con la
longitud hocico cloaca. También vemos que el tiempo de reacción se
correlaciona positivamente con la velocidad.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggpairs_dfnum.html">ggpairs_dfnum</a></span><span class="op">(</span><span class="va">df</span>, var.response <span class="op">=</span> <span class="st">"Velocidad"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>Ahora vamos a graficar la velocidad por Localidad, para ello usaremos
la paquetería <em>ggpubr</em>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html" class="external-link">ggboxplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Localidad"</span>, <span class="st">"Velocidad"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Localidad"</span>, palette <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>, <span class="st">"darkblue"</span><span class="op">)</span>,</span>
<span>    add <span class="op">=</span> <span class="st">"jitter"</span>, fill <span class="op">=</span> <span class="st">"Localidad"</span>, alpha<span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Y si quisiéramos saber que si nuestra variable de respuesta sigue una
distribución normal podemos hacer un histograma de frecuencias. Para
ello usamos la función <em>hist_curva</em>. A la izquierda tenemos el
histograma y a la derecha el Q-Q plot que nos muestra la distribución de
nuestra variable de respuesta.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hist_curva.html">hist_curva</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Velocidad</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prueba de normalidad</span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  variable</span></span>
<span><span class="co">#&gt; D = 0.1, p-value = 0.02</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; [1] 22 87</span></span></code></pre>
<p>La prueba de Kolmogorov-Smirnov indica que no la distribución NO es
parecida a la normal. Además nos dice que hay dos datos extremos, el 22
y 87. Tenemos que revisar estas observaciones.</p>
<p>Si quisieramos hacer la prueba de normalidad por localidad podemos
usar las funciones <em>norm.shapiro.grupos</em>,<em>norm.ad.grupos</em>
o <strong>norm.lks.grupos</strong>. Si queremos usar una prueba Shapiro
Wilk:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/norm.shapiro.grupos.html">norm.shapiro.grupos</a></span><span class="op">(</span><span class="va">Velocidad</span><span class="op">~</span> <span class="va">Localidad</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prueba de normalidad de Shapiro-Wilk por grupos.</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<table class="table">
<caption>Prueba de normalidad de Shapiro-Wilk por grupos</caption>
<thead><tr class="header">
<th align="right">Localidad</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">Localidad_A</td>
<td align="right">0.95</td>
<td align="right">0.23</td>
</tr>
<tr class="even">
<td align="right">Localidad_B</td>
<td align="right">0.96</td>
<td align="right">0.47</td>
</tr>
<tr class="odd">
<td align="right">Localidad_C</td>
<td align="right">0.98</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td align="right">Localidad_D</td>
<td align="right">0.52</td>
<td align="right">5.59e-08</td>
</tr>
</tbody>
</table>
<p>La prueba nos muestra que todas las localidades, excepto la D, se
distribuyen normalmente. Al menos numericamente, por que visualmente
todas se ajustan perfectamente. Conviene revisar el punto que sale fuera
de la distribución, como haremos más adelante.</p>
<p>Podemos ajustar un modelo lineal generalizado (GLM). Los modelos
lineales generalizados pueden tener errores o distribuciones no
normales. Sin embargo, existen limitaciones en cuanto a las posibles
distribuciones. Por ejemplo, se puede utilizar la familia Poisson para
datos de conteos, o puede utilizar la familia binomial para datos
binomiales. La distribución gaussiana es adecuada cuando los errores en
el modelo siguen una distribución normal y la variable de respuesta
también se distribuye normalmente.</p>
<p>Con esta base de datos vamos a ajustar dos modelos lineales
generalizados, el primero con la distribución gaussiana y función de
liga ‘log’. El segundo con distribución gaussiana y función de liga
‘identity’. Usaremos la Velocidad como variable de respuesta. Además,
usaremos la variable longitud hocico-cloaca (LHC) y Localidad como
variables explicativas.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Velocidad</span> <span class="op">~</span> <span class="va">LHC</span> <span class="op">+</span> <span class="va">Localidad</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="st">"log"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">modelo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Velocidad</span> <span class="op">~</span> <span class="va">LHC</span> <span class="op">+</span> <span class="va">Localidad</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="st">"identity"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">modelo</span>, <span class="va">modelo2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         df AIC</span></span>
<span><span class="co">#&gt; modelo   6 327</span></span>
<span><span class="co">#&gt; modelo2  6 326</span></span></code></pre></div>
<p>De acuerdo con el Criterio de información de Akaike (AIC), el primer
modelo2 es mejor. Vamos a ver el summary del modelo y la tabla ANOVA
tipo III:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelo2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = Velocidad ~ LHC + Localidad, family = gaussian("identity"), </span></span>
<span><span class="co">#&gt;     data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></span>
<span><span class="co">#&gt; -2.353  -0.459  -0.046   0.321   8.871  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)             1.218      2.890    0.42   0.6744   </span></span>
<span><span class="co">#&gt; LHC                     0.533      0.328    1.62   0.1080   </span></span>
<span><span class="co">#&gt; LocalidadLocalidad_B   -1.084      0.450   -2.41   0.0179 * </span></span>
<span><span class="co">#&gt; LocalidadLocalidad_C   -2.056      0.614   -3.35   0.0012 **</span></span>
<span><span class="co">#&gt; LocalidadLocalidad_D   -2.880      0.943   -3.05   0.0029 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.43)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 171.75  on 99  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 135.94  on 95  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 326.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>La LCH no es significativa p&gt;0.001 pero… Atención: Debemos revisar
el ajuste del modelo antes de hacer cualquier interpretación de
resultados. Esto lo podemos hacer con la función <em>resid_glm</em>.</p>
<p>Para explorar un modelo lineal generalizado (GLM) hay varios
criterios que se pueden evaluar para comprobar el buen ajuste de un
modelo.</p>
<p>Normalidad: Los residuales son las diferencias entre los valores
observados y los valores predichos por el modelo. Si los residuos siguen
una distribución normal, eso significa que los errores del modelo son
aleatorios y no presentan patrones que indiquen un mal ajuste del
modelo.</p>
<p>Homocedasticidad: Comprobar si la varianza de los residuales es
constante en todo el rango de los valores ajustados. Esto se puede
evaluar mediante gráficos de dispersión de los residuales estandarizados
o los residuales absolutos frente a los valores ajustados.</p>
<p>Influencia de observaciones influyentes (outliers): Identificar
observaciones influyentes o valores atípicos que puedan tener un impacto
desproporcionado en el modelo. Esto se puede hacer mediante la detección
de valores altos de los residuales estandarizados.</p>
<p>Autocorrelación: Revisar si hay autocorrelación en los residuales, lo
que indica la presencia de dependencia entre las observaciones. Esto se
puede evaluar mediante pruebas de autocorrelación o trazando gráficos de
autocorrelación de los residuales.</p>
<p>Multicolinealidad: Examinar la presencia de alta correlación entre
las variables predictoras, lo que puede dificultar la interpretación de
los coeficientes del modelo. Esto se puede evaluar mediante el cálculo
del factor de inflación de la varianza (VIF) para cada variable
predictora. Vamos a explorar los residuales del modelo:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modelo2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>En la primera gráfica, la línea roja es horizontal y aplanada sobre
la línea punteada, indica buen ajuste, homocedasticidad. El QQPlot se ve
bien, la mayoría de los puntos se ajustan a la línea punteada, lo cual
indica que los residuales se aproximan a la distribución normal. Pero si
vemos el gráfico de abajo a la derecha notamos que tenemos una
observación influyente, el dato 22.</p>
<p>En un GLM, los outliers pueden influir en los resultados y sesgar las
estimaciones de los coeficientes. Por lo tanto, es importante
identificar y, en algunos casos, remover los outliers antes de ajustar
el modelo. Existen varios criterios comunes para identificar outliers en
un GLM:</p>
<ol style="list-style-type: decimal">
<li><p>Residuos estandarizados: Los residuos estandarizados son una
medida de la distancia entre los valores observados y los valores
predichos por el modelo. Los outliers pueden ser identificados como
aquellos puntos cuyos residuos estandarizados están por encima de un
umbral determinado, como 2 o 3 desviaciones estándar. Podemos
analizarlos con la función <em>outliers.plot</em>.</p></li>
<li><p>Distancia de Cook: La distancia de Cook es una medida de la
influencia de cada observación en los coeficientes del modelo. Los
puntos con una distancia de Cook alta pueden considerarse outliers y
pueden ser removidos. Podemos analizarlos con la función
<em>outliers.plot2</em>.</p></li>
<li><p>Gráficos de residuos: Los gráficos de residuos, como el gráfico
de residuos vs valores ajustados o el gráfico de residuos versus
variables explicativas, pueden ayudar a identificar outliers
visualmente. Los puntos que se encuentran lejos de la línea de
referencia en estos gráficos pueden ser considerados outliers. Podemos
explorarlos visualmente con la gráfica anterior, Residuals VS
Leverage.</p></li>
</ol>
<p>Vamos a comprobarlo.</p>
<p>Primero, podemos usar la función <em>outliers.plot</em> para
comprobar estas observaciones influyentes:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outliers.plot2.html">outliers.plot2</a></span><span class="op">(</span><span class="va">modelo2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Las distancias de Cook, es una medida de cómo influye la observación identificada como outlier sobre la estimación de B (pendiente) al ser retirada del conjunto de datos. Una distancia de Cook grande significa que una observación tiene un peso grande en la estimación de la pendiente. En el gráfico las observaciones con círculos grandes son consideradas outliers influyentes.</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>El dato que se encuentra en la fila 22 tiene un valor de std.resid
mayor a 3, y el valor de p con ajuste de Bonferroni es &lt; 0.05, lo que
nos indica que puede ser un dato influyente y tenemos que revisar esta
observación.</p>
<p>También podemos usar la función <em>outliers.DHARMa</em> para
comprobar estas observaciones influyentes:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outliers.DHARMa.html">outliers.DHARMa</a></span><span class="op">(</span><span class="va">modelo2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Si el valor de p &lt; 0.05, entonces hay observaciones influyentes en nuestros datos. ¿Que hacer con los outlieres? algunos investigadores sugieren remover algunos outliers (no todos), de esta forma se puede lograr un mejor ajuste del modelo.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  DHARMa outlier test based on exact binomial test with approximate</span></span>
<span><span class="co">#&gt;  expectations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  res.mod</span></span>
<span><span class="co">#&gt; outliers at both margin(s) = 1, observations = 100, p-value = 0.6</span></span>
<span><span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.00797</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.000253 0.054459</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; frequency of outliers (expected: 0.00796812749003984 ) </span></span>
<span><span class="co">#&gt;                                                   0.01</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<pre><code><span><span class="co">#&gt; Esta función usa bootstrap para simular los outliers (posibles) basándose en la simulación de los valores atípicos. Las observaciones mas influyentes son:</span></span>
<span><span class="co">#&gt; [1] 22</span></span></code></pre>
<p>Tendremos que corroborar que esta observación es correcta y no
cometimos ningún error al capturar nuestros datos. Vamos a suponer que
fue un error de medición y no podemos confiar en este dato, y no hay
forma de repetir la medición. Así que lo vamos a remover y volver a
ajustar el modelo:</p>
<p>Una forma de remover los outliers es usando la función
<em>outlierKD</em> que remueve todas las observaciones influyentes.</p>
<p>Pero vamos a remover manualmente esta observación:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">modelo3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Velocidad</span> <span class="op">~</span> <span class="va">LHC</span>  <span class="op">+</span> <span class="va">Localidad</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="st">"identity"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">df2</span><span class="op">)</span></span></code></pre></div>
<p>Pero volvemos a corroborar los residuales del modelo para saber si
hay un buen ajuste:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>Examinamos el resumen del modelo:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = Velocidad ~ LHC + Localidad, family = gaussian("identity"), </span></span>
<span><span class="co">#&gt;     data = df2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -1.4472  -0.3684   0.0471   0.3916   1.3952  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)            14.039      1.581    8.88  4.4e-14 ***</span></span>
<span><span class="co">#&gt; LHC                    -0.929      0.180   -5.17  1.3e-06 ***</span></span>
<span><span class="co">#&gt; LocalidadLocalidad_B    0.236      0.231    1.02     0.31    </span></span>
<span><span class="co">#&gt; LocalidadLocalidad_C    0.224      0.325    0.69     0.49    </span></span>
<span><span class="co">#&gt; LocalidadLocalidad_D    0.570      0.498    1.15     0.26    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.337)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 87.756  on 98  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 31.680  on 94  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 180.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>Comprobamos si aún tenemos outliers en el nuevo modelo:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outliers.plot.html">outliers.plot</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span>
<span><span class="co">#&gt;  ################################################################################################</span></span>
<span><span class="co">#&gt; Observaciones con std.resid (residuales estandarizados) &gt; 3, son consideradas valores atípicos. Index es número de fila donde se encuentra la observación.</span></span>
<span><span class="co">#&gt;  ################################################################################################</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 × 10</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 variables: Velocidad &lt;dbl&gt;, LHC &lt;dbl&gt;, Localidad &lt;fct&gt;, .fitted &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .resid &lt;dbl&gt;, .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;, cooksd &lt;dbl&gt;, StdResid &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   outlierID &lt;int&gt;</span></span></span>
<span><span class="co">#&gt;  ################################################################################################</span></span>
<span><span class="co">#&gt; En el gráfico de la derecha se marcan en rojo las observaciones influyentes.No todos los outliers son observaciones influyentes. Para revisar que los datos contienen potenciales datos influyentes, se puede inspeccionar los residuales estandarizados. Datos con residuales estandarizados absolutos mayores a 3 representan posibles outliers y merecen atención. Sugerencia: 1) remover, 2)transformar los datos, 3) usar métodos no paramétricos. A continuación se hace una prueba Bonferroni para cada dato identificado como outlier.</span></span>
<span><span class="co">#&gt;  ################################################################################################</span></span>
<span><span class="co">#&gt; No Studentized residuals with Bonferroni p &lt; 0.05</span></span>
<span><span class="co">#&gt; Largest |rstudent|:</span></span>
<span><span class="co">#&gt;    rstudent unadjusted p-value Bonferroni p</span></span>
<span><span class="co">#&gt; 22    -2.63             0.0085        0.841</span></span>
<span><span class="co">#&gt;  ################################################################################################</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-19-1.png" width="576"></p>
<p>Ya no tenemos outliers, lo ideal sería evitar remover observaciones.
Pero si estamos seguros de que el outlier es un error o no es una
observación confiable tenemos que quitarla de la base de datos.</p>
<p>Ahora vamos a revisar la multicolinealidad usando la función
<em>VIF_model</em> y <em>VIF_plot</em>. La multicolinealidad en los
modelos de regresión generalizada (GLM) se refiere a la presencia de
alta correlación entre las variables predictoras. Esto puede causar
problemas en la estimación de los coeficientes de regresión, ya que
dificulta la identificación de la contribución individual de cada
variable en el modelo.</p>
<p>Cuando existe multicolinealidad, las estimaciones de los coeficientes
pueden volverse inestables y poco confiables. Además, la
multicolinealidad puede hacer que los intervalos de confianza sean
demasiado amplios, lo que dificulta la interpretación de los
resultados.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/VIF_model.html">VIF_model</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Comprobación de la multicolinealidad</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlación moderada</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Term  VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI</span></span>
<span><span class="co">#&gt;        LHC 9.54 [6.80, 13.56]         3.09      0.10     [0.07, 0.15]</span></span>
<span><span class="co">#&gt;  Localidad 9.54 [6.80, 13.56]         3.09      0.10     [0.07, 0.15]</span></span>
<span><span class="fu"><a href="../reference/VIF_plot.html">VIF_plot</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variable `Component` is not in your data frame :/</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Hay diferentes criterios de seleccipon pero en general un valor VIF
mayor a 1 indica la presencia de multicolinealidad, y valores superiores
a 5 o 10 suelen ser considerados problemáticos. Por lo que quizá
convendria remover alguna de las dos variables o analizar por separado
cada variable. Por ahora vamos a ignorar este problema y asumir que no
hay problemas.</p>
<p>El modelo tiene buen ajuste y ya podemos examinar los resultados con
la tabla de ANOVA tipo III usando la función <em>table_ANOVA3</em>. La
tabla de ANOVA tipo III es útil para evaluar la importancia relativa de
las variables del modelo y determinar qué variables tienen un efecto
significativo en la variable de respuesta.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_ANOVA3.html">table_ANOVA3</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span></code></pre></div>
<table style="border-collapse:collapse; border:none;" class="table">
<caption style="font-weight: bold; text-align:left;">
Analysis of Deviance Table (Type III tests)
</caption>
<tr>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; text-align:left; ">
Variables
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
LR.Chisq
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
DF
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
P.value
</th>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
LHC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
26.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
1
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
&lt;0.001 ***
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; border-bottom: double; ">
Localidad
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
2.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
3
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
0.550
</td>
</tr>
<tr>
<td colspan="5" style="font-style:italic; border-top:double black; text-align:right;">
&lt;0.001 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’
</td>
</tr>
</table>
<p>En el modelo ahora muestra que la variable LHC es significativa, pero
no hay un efecto significativo de la localidad. Vamos a graficar los
efectos del modelo con la función <em>plot_effects</em>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects.html">plot_effects</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<p>o bien con la función <em>plot_effects2</em>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects2.html">plot_effects2</a></span><span class="op">(</span><span class="va">modelo3</span>, lineas <span class="op">=</span> <span class="cn">TRUE</span>, puntos <span class="op">=</span> <span class="cn">TRUE</span>, grids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-23-1.png" width="768"></p>
<p>Otra forma de graficar las variables es usando el paquete
<em>ggeffects</em>. Este paquete nos permite obtener gráficos estéticos
usando <em>ggplot</em> como interfaz.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/" class="external-link">ggeffects</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html" class="external-link">ggeffect</a></span><span class="op">(</span><span class="va">modelo3</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LHC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-24-1.png" width="576"></p>
<p>Y podemos usar los diferentes temas predefinidos para artículo
científico o para presentación. Por ejemplo:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dat</span>, add.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="../reference/tema_articulo.html">tema_articulo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># o cambiar los parámetros de tamaño de letra en los ejes X y Y:</span></span>
<span><span class="co">#pl + tema_articulo(14,14)</span></span>
<span><span class="co">#pl + tema_articulo2()</span></span>
<span><span class="co">#pl + tema_presentacion()</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="../reference/tema_articulo2.html">tema_articulo2</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># o cambiar los parámetros de tamaño de letra en los ejes X y Y:</span></span>
<span><span class="co">#pl + tema_articulo(14,14)</span></span>
<span><span class="co">#pl + tema_articulo2()</span></span>
<span><span class="co">#pl + tema_presentacion()</span></span></code></pre></div>
<p>Ahora vamos a obtener la tabla del modelo. De esta forma podremos
copiar las tablas y pegarlas directamente en nuestro documento de
Word.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table.models.html">table.models</a></span><span class="op">(</span><span class="va">modelo3</span><span class="op">)</span></span></code></pre></div>
<table style="border-collapse:collapse; border:none;" class="table">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Velocidad
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
std. Error
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
14.039
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.581
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
8.882
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
LHC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.929
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.180
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-5.169
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad [Localidad_B]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.236
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.231
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.021
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.307
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad [Localidad_C]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.224
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.325
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.690
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.490
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad [Localidad_D]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.570
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.498
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.145
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.252
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
99
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.639
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
AIC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
180.145
</td>
</tr>
</table>
<p>Luego vamos a obtener los contrastes post-hoc Tuckey, en este caso la
Localidad no es significativa pero para fines demostrativos vamos a
hacerlo usando la paquetería <em>emmeans</em>. Y usando la función
<em>table_contrasts</em> para obtener los contrastes en una tabla.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="va">cont1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">modelo3</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Localidad</span>,adjust<span class="op">=</span><span class="st">"tukey"</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span><span class="op">$</span><span class="va">contrasts</span></span>
<span><span class="fu"><a href="../reference/table_contrasts.html">table_contrasts</a></span><span class="op">(</span><span class="va">cont1</span><span class="op">)</span></span></code></pre></div>
<table style="border-collapse:collapse; border:none;" class="table">
<tr>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; text-align:left; ">
contrast
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
estimate
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
SE
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
df
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
t.ratio
</th>
<th style="border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; ">
p.value
</th>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad_A - Localidad_B
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.230
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.230
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-1.020
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.738
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad_A - Localidad_C
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.220
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.324
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.690
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.901
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad_A - Localidad_D
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.570
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.498
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-1.140
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.663
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad_B - Localidad_C
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.011
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.202
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.056
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
1.000
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Localidad_B - Localidad_D
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.330
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.349
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
-0.950
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; ">
0.773
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; border-bottom: double; ">
Localidad_C - Localidad_D
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
-0.340
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
0.251
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
-1.370
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center; border-bottom: double; ">
0.518
</td>
</tr>
<tr>
<td colspan="7" style="font-style:italic; border-top:double black; text-align:right;">
&lt;0.001 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’
</td>
</tr>
</table>
<p>Finalmente, vamos a graficar los efectos en un boxplot y colocar los
valores de p que acabamos de obtener anteriormente:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boxplot_emmeans.html">boxplot_emmeans</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Velocidad</span> <span class="op">~</span> <span class="va">Localidad</span>, modelo<span class="op">=</span><span class="va">modelo3</span>, data<span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tlamatini-Modelos-Lineales-Generalizados-GLM_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   group1      group2         df statistic     p p.adj p.adj.signif</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Localidad_A Localidad_B    94   -<span style="color: #BB0000;">1.02</span>   0.310     1 ns          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Localidad_A Localidad_C    94   -<span style="color: #BB0000;">0.690</span>  0.492     1 ns          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Localidad_A Localidad_D    94   -<span style="color: #BB0000;">1.15</span>   0.255     1 ns          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Localidad_B Localidad_C    94    0.056<span style="text-decoration: underline;">6</span> 0.955     1 ns          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Localidad_B Localidad_D    94   -<span style="color: #BB0000;">0.958</span>  0.340     1 ns          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Localidad_C Localidad_D    94   -<span style="color: #BB0000;">1.38</span>   0.172     1 ns</span></span></code></pre>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mario A. Sandoval-Molina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
